<template>
    <transition name="on-boarding">
        <div class="on-boarding" v-if="open">

            <div class="on-boarding__body">

                <div class="on-boarding__body__content" v-if="onboard === 0">
                    <p class="on-boarding__body__title canala-deck">Bienvenue chez MOP !</p>
                    <p class="on-boarding__body__sub-title">Nous allons vous aider à utiliser MOP pour la première fois.</p>
                    <button class="on-boarding__body__button hover" v-on:click="onboard += 1">Continuer</button>
                </div>

                <transition name="left">
                    <div class="on-boarding__body__content" v-if="onboard === 1">
                        <p class="on-boarding__body__content__title canala-deck">Type de rappel</p>
                        <p class="on-boarding__body__content__sub-title">Choisissez le type de rappel pour votre bracelet</p>

                        <div class="on-boarding__bory__content__rappels">
                        
                            <div
                                class="on-boarding__bory__content__rappels__one-rappel hover"
                                v-on:click="sonor = !sonor"
                                v-bind:class="{'on-boarding__bory__content__rappels__one-rappel-active-sonor': sonor}"
                            >
                                <svg data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" width="634.35269" height="495.02832" viewBox="0 0 634.35269 495.02832" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M748.60119,597.8613q-2.99085-32.8374-5.98169-65.67431c-2.21142-24.28028-5.62683-51.04248-23.92041-67.15967-14.75769-13.00195-36.37219-15.793-55.66882-11.98779s-36.89771,13.36767-54.15515,22.80273l-18.7367-.81885a42.78439,42.78439,0,0,0-78.68188-.45459c-5.34339,12.3042-4.62647,26.27686-3.81372,39.66651q2.05481,33.85107,4.10962,67.70166c1.93188,31.82568,5.03955,66.4873,26.97815,89.62451,15.82507,16.689,39.28833,24.42529,62.25073,25.72461,22.96252,1.2998,45.81482-3.18555,68.37683-7.64844,28.95605-5.72754,61.89624-14.39795,74.72021-40.9834C751.55981,633.144,750.16308,615.01072,748.60119,597.8613Z" transform="translate(-282.82365 -202.48584)" fill="#0049be"/><path d="M445.82543,443.89792c61.79205,18.35108,160.64658-27.72039,209.33215.655A1413.46494,1413.46494,0,0,1,691.671,599.56883c23.68424,62.44789-64.69856,57.2737-104.47167,55.40094-34.36263-6.337-80.45542.15864-104.118-29.98728-26.98276-56.29844-35.13047-121.04725-33.53326-183.13137-2.873,64.65432-1.87333,140.30493,34.32843,196.46337,53.77213,32.44578,129.62558,34.81884,190.30554,21.63462,74.38241-12.16316-1.58588-164.3218-8.40919-213.21835C641.99879,394.10416,499.64158,462.13316,445.82543,443.89792Z" transform="translate(-282.82365 -202.48584)"/><path d="M624.97045,434.7241c87.92408-37.5952-37.45991-72.37191-77.97826-64.168-38.85709-3.316-133.15587,22.7895-78.95556,70.69937a41.39764,41.39764,0,0,1-9.54921-13.318C421.93128,355.79182,738.74855,375.23767,624.97045,434.7241Z" transform="translate(-282.82365 -202.48584)"/><path d="M700.79463,564.55591c16.63727-20.964,29.8557-44.42814,42.09276-68.14493.88848-3.238,7.18,2.3987,8.89379,2.42477,2.92431.72793,8.46912,4.84168,4.75912,7.04712-10.63334,28.32181,44.75334,4.8454,52.11737-6.10386.66553-9.22176-11.21481-11.47606-18.06459-13.5339,3.99-14.95176,7.67476-30.69721,4.31751-46.03374-24.33122-71.56007-99.19118-.30892-55.01084,47.13018-15.83256,23.33919-35.92937,44.816-57.03446,63.73532,14.4461-14.52066,27.77227-31.38126,39.808-48.5801,17.83364-21.67422,5.88444-13.25606-1.582-34.539-21.95471-97.66171,114.46812-84.88138,83.99623,9.96494,59.01368,29.9057-71.3705,80.03814-56.13761,28.43967,2.93063-.35714-.54079-1.26367-1.73445-2.217C735.447,517.6358,717.80126,549.363,700.79463,564.55591Z" transform="translate(-282.82365 -202.48584)"/><path d="M809.32988,517.94452c.61978,18.3132-21.81086,25.88154-33.40564,12.4817C787.58864,527.93831,798.38376,523.17292,809.32988,517.94452Z" transform="translate(-282.82365 -202.48584)"/><path d="M774.03481,445.33185c-5.40077-16.4664-16.89486-30.509-9.69748-2.73308.10957.58622,2.93457,14.87594,6.99174,7.45571,6.32069-47.50425,10.57618,45.4536-8.18458,11.25851C727.0258,420.81337,773.65416,387.101,774.03481,445.33185Z" transform="translate(-282.82365 -202.48584)"/><path d="M460.62907,548.04483A470.64655,470.64655,0,0,0,387.3429,500.3386c-.57253-.16066.22155-.936.301-1.30729.04746.161-.3862.792-.39493,1.01248.04213-.249.8048-1.67245.95028-2.11429,39.10855,12.93493,17.63806-56.37848-3.57255-69.76484-12.9242-6.48974-23.817,5.72151-28.70832,14.91736-60.64074-20.7814-108.94851,66.2442-37.39893,85.85543,84.64305-3.01631,14.659-54.09322,135.22046,35.06345-123.96817-110.09285-55.85309-30.76221-142.25411-47.91881-47.48234-31.33261,8.44882-75.97844,48.1085-60.18236,10.96069,5.74279,9.53557-34.26747,25.58548-11.47848,6.9713,10.5256,30.96667,54.37133,2.88155,45.63047-4.9282-4.4459-7.01724,7.23024-8.9309,11.03967-.21765.86856-1.76122,2.904.0535,3.00146A567.68924,567.68924,0,0,1,460.62907,548.04483Z" transform="translate(-282.82365 -202.48584)"/><path d="M396.10228,436.59661c5.30292,13.91786,14.57345,20.94311,23.17112,32.58312C424.18856,454.84731,411.95879,435.067,396.10228,436.59661Z" transform="translate(-282.82365 -202.48584)"/><path d="M326.34219,476.80955c-41.16955-4.13768-37.92241,44.8873,2.16344,19.61316,4.49726-2.45175,23.8406-19.095,12.01509-17.75339-8.39849-.28891-30.8402,5.07076-17.75926,7.4881a80.01962,80.01962,0,0,1-13.26623,5.17453C302.44348,487.9551,321.84328,478.68635,326.34219,476.80955Z" transform="translate(-282.82365 -202.48584)"/><path d="M844.28971,560.76144c-5.4338,9.60525-9.0603,4.35665-12.4965-2.5357-1.729-1.6441-7.59811-11.86768-7.41515-6.47171-2.28264,7.94364-7.27774-29.14875-6.39391-13.94169-1.24982,11.8132,25.04611,100.42241-6.71492,63.82434,3.4596-20.78707-8.126,6.28489,3.10441,11.40685,28.23181,13.62952,27.23624-28.45034,18.7348-44.53838C833.78845,573.87863,846.60965,566.46022,844.28971,560.76144Z" transform="translate(-282.82365 -202.48584)"/><path d="M916.4832,661.71408c-2.40016,22.13913-30.597,2.20073-9.07561-6.26654,5.929-2.14426,12.25852-1.00193,8.77383-9.10322-4.1424-23.50841-8.76576-47.83672-14.15644-71.14339-5.74037,4.29587-19.74494,14.13548-25.23858,18.37139-26.825,13.09077-8.78744,43.99335-7.18892,66.318,9.24944,16.23661-5.69835,46.68547-18.62369,20.75494C863.5487,642.1541,832.374,694.14669,864.64708,694.595c12.22844-1.15227,14.99419-15.66911,13.82252-25.5099-1.15438-18.98367-4.36491-38.631-4.89648-57.5555,6.34264-5.71926,14.24847-10.23063,20.71517-15.81218,4.88,16.9778,8.54821,34.44107,13.75647,51.27743C876.047,657.50182,910.67711,695.27743,916.4832,661.71408Z" transform="translate(-282.82365 -202.48584)"/><path d="M415.64081,229.137c-5.43348,9.605-9.0608,4.35618-12.49638-2.53619-1.72918-1.64416-7.59865-11.868-7.41516-6.47123-2.28169,7.94627-7.27923-29.1532-6.39391-13.94169-1.25008,11.81322,25.04646,100.42182-6.71491,63.82435,3.45922-20.78645-8.12572,6.2838,3.10441,11.40685,28.23241,13.62826,27.23588-28.45009,18.7348-44.53887C405.14022,242.25444,417.96061,234.8351,415.64081,229.137Z" transform="translate(-282.82365 -202.48584)"/><path d="M487.83441,330.08962c-2.4002,22.139-30.59723,2.20019-9.07573-6.26654,5.92966-2.14473,12.2584-1.00167,8.774-9.10371-4.14252-23.50857-8.76611-47.83667-14.15644-71.14339-5.74037,4.29587-19.74494,14.13548-25.23858,18.37139-26.825,13.09127-8.7875,43.99312-7.18905,66.318,9.24967,16.23675-5.69822,46.68553-18.62356,20.75494,12.58613-38.50488-18.60494,13.50763,13.67317,13.94976,12.22886-1.15181,14.99419-15.66908,13.82263-25.50989-1.15452-18.98309-4.36489-38.63087-4.89648-57.555,6.34252-5.71923,14.24813-10.23106,20.71517-15.81217,4.88006,16.97757,8.54813,34.44092,13.75648,51.27743C447.39792,325.87625,482.02833,363.65317,487.83441,330.08962Z" transform="translate(-282.82365 -202.48584)"/></svg>
                                <p class="on-boarding__bory__content__rappels__one-rappel__p">Sonore</p>
                            </div>

                            <div
                                class="on-boarding__bory__content__rappels__one-rappel hover"
                                v-on:click="vibror = !vibror"
                                v-bind:class="{'on-boarding__bory__content__rappels__one-rappel-active-vibror': vibror}"
                            >
                                <svg data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" width="348.36586" height="253.9449" viewBox="0 0 348.36586 253.9449" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M592.79213,547.86022c-19.18663.47554-19.13688,28.58472,0,29.11223C611.97965,576.49691,611.9299,548.388,592.79213,547.86022Z" transform="translate(-425.81707 -323.02755)"/><path d="M684.3462,502.59315a139.78114,139.78114,0,0,0-20.0644-36.793c-14.63163-20.12437-34.24649-38.40458-58.79572-44.96878-21.07455-5.00277-45.104-1.76354-62.34323,11.9319-22.5689,19.148-31.43281,48.83681-43.41868,74.90725,18.26532-24.12611,32.49893-51.36307,54.13231-64.23026,13.41537-6.4627,21.92835-7.42909,38.375-6.15064,10.06507.81025,22.77946,5.07052,36.92956,14.27692,18.56828,12.41566,40.50284,33.90844,54.254,56.42115q2.89186,4.611,5.64512,9.3068C687.66273,512.34083,686.11063,507.42912,684.3462,502.59315Z" transform="translate(-425.81707 -323.02755)"/><path d="M770.36355,487.84091c-5.1698-25.58447-15.61957-49.99754-28.58183-72.56955-46.2448-78.17781-146.09418-127.1019-236.90019-61.97187-37.985,29.00228-59.39541,73.66766-79.06446,116.04888,12.60333-17.67763,23.78073-35.59513,36.26856-50.12392,17.51016-19.87362,31.34931-34.90926,50.01354-46.05556,59.45849-36.17417,132.53223-17.73,180.04749,25.4954,27.0786,25.57381,35.28773,35.59891,52.47894,61.28222,11.16585,16.99109,19.48071,33.30986,25.252,49.14776,1.49523,3.91222,2.94871,7.84288,4.30535,11.8033A269.29234,269.29234,0,0,0,770.36355,487.84091Z" transform="translate(-425.81707 -323.02755)"/><path d="M457.22959,452.65743c25.782-53.69179,88.72584-86.83006,147.58273-77.69841s108.80054,59.78441,117.10155,118.76419C697.22765,448.72867,650.126,416.781,599.192,410.4845S494.79447,423.70379,457.22959,452.65743Z" transform="translate(-425.81707 -323.02755)" fill="#0049be"/></svg>
                                <p class="on-boarding__bory__content__rappels__one-rappel__p">Vibreur</p>
                            </div>

                            <div
                                class="on-boarding__bory__content__rappels__one-rappel hover"
                                v-on:click="led = !led"
                                v-bind:class="{'on-boarding__bory__content__rappels__one-rappel-active-led': led}"
                            >
                                <svg data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" width="130.85891" height="319.38996" viewBox="0 0 130.85891 319.38996" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M626.695,345.22826l.10521-.01423c-1.7726-14.94971-6.97625-25.48217-12.83485-28.65677A20.27221,20.27221,0,0,0,598.18,313.56252c-26.63887,5.98753-35.60175,51.91746-33.49065,89.66924,1.14861,19.27976,4.93435,38.73281,13.80235,56.02733,6.19013,11.94925,12.32779,24.24593,21.28788,34.39439-7.05243-13.43036-10.52729-29.12572-14.44307-44.14994-2.44876-11.35666-3.16037-24.279-2.67341-39.53734,1.78683-24.5688,1.38414-23.27829,6.80658-48.02443.93066-3.86206,1.90849-7.30986,2.88967-10.3519a38.27533,38.27533,0,0,1,3.55189-5.71935c-1.3074,1.69934-.32622.41608.51235-.66933-.15571.21-.28464.38538-.27794.36724,3.98806-4.62041,2.84754-3.93476,6.45831-5.837.156-.05791.30836-.12433.46631-.17679.03823-.01312.07981-.01437.11832-.02679.17636.04479.35078.09363.52519.14721.30836.29761.60807.60151.89076.92424.73226,1.21629,1.24629,2.04078,1.61242,2.62792q.73671,2.14026,1.40032,4.30438c1.05625,6.09036,6.07655,11.15127,12.54993,9.36528C626.49968,354.52461,627.75043,350.02838,626.695,345.22826Z" transform="translate(-534.57054 -290.30502)" fill="#0049be"/><path d="M661.00388,542.308c-5.62614-8.98283-15.10612-16.08019-25.84745-17.0855a37.717,37.717,0,0,0-10.92775.74076,34.238,34.238,0,0,1,15.30761,4.05713,34.75031,34.75031,0,0,1,13.285,15.3037c1.89985,5.00426,2.10468,7.7445,1.61046,13.0334-.64324,3.22022-2.2869,11.32819-6.84062,17.52851a33.498,33.498,0,0,1-4.02462,4.52316,52.42932,52.42932,0,0,1-4.91872,4.39744c-15.77392,10.94184-35.98128,12.97019-48.93054,5.79749-5.85023-3.385-4.97454-2.362-8.66763-6.21511-1.49074-2.07356-2.00756-2.17458-3.71821-8.39638-2.47192-10.99779,2.39128-17.51512,12.81113-25.74532,8.23286-5.29672,18.17245-7.18289,27.24-10.65566-9.19143,1.38665-18.70238,1.82255-27.55642,4.79468a51.09785,51.09785,0,0,0-17.74688,12.69937c-4.27075,5.15983-5.6987,12.021-5.65266,18.58447-.17776,15.94973,11.85423,26.25294,25.77937,31.49035,14.33591,4.63855,30.25215,2.67019,43.64791-3.94885C657.60939,593.33752,673.551,564.77954,661.00388,542.308Z" transform="translate(-534.57054 -290.30502)"/><path d="M636.7228,312.22722c-7.89826-15.14464-24.97819-25.03191-42.08964-21.02947-27.43,5.9059-47.30194,30.41163-55.777,56.12723-8.20048,23.622-3.39058,49.32569,4.0369,72.51425a238.33,238.33,0,0,0,19.82421,44.8589c9.37923,15.49485,19.96485,30.248,30.19968,45.18484-9.999-23.0535-18.86116-40.157-25.76959-60.07637-8.15584-24.3729-13.18089-46.76907-14.13639-67.16884-.09265-13.10386-.04214-13.73607,2.40495-24.714.391-2.02277,3.45393-10.19116,3.52788-10.5372,10.99249-26.21944,34.45258-42.49288,49.77777-37.01491,9.49644,3.79076,17.14717,16.995,16.52068,40.11123-.547,18.5309-4.11922,36.8359-6.08241,55.2482-2.3603,19.88434-4.22666,39.86845-4.38851,59.90474-.569,15.333,1.70729,30.64828,1.09559,45.94445-.93346-.12-1.86859-.22632-2.80847-.2813-6.60927-.45947-13.22162-.90667-19.80858-1.6226a193.78206,193.78206,0,0,0,19.846,5.81968c2.05612.32217,4.42646,1.85185,6.30621.36431a3.91653,3.91653,0,0,0,1.27392-2.24407,58.21883,58.21883,0,0,0,1.63864-9.00459c.85812-9.55616,1.80581-19.106,2.91256-28.637,2.33462-21.03212,7.78468-49.32443,12.43384-74.7173,3.114-18.65257,6.88638-37.47048,6.44854-56.45513C643.64685,333.62156,642.05928,322.21522,636.7228,312.22722Z" transform="translate(-534.57054 -290.30502)"/><path d="M614.49662,550.28747c-17.95728.44507-17.9103,26.753.00083,27.24691C632.45473,577.08931,632.40817,550.78118,614.49662,550.28747Z" transform="translate(-534.57054 -290.30502)" fill="#0049be"/></svg>
                                <p class="on-boarding__bory__content__rappels__one-rappel__p">Lumineux</p>
                            </div>
                        </div>

                        <button class="on-boarding__body__button hover" v-on:click="putRappels">Continuer</button>
                    </div>
                </transition>


                <transition name="left">
                    <div class="on-boarding__body__content" v-if="onboard === 2">
                        <p class="on-boarding__body__content__title canala-deck">Avez-vous des difficultés ?</p>
                        <p class="on-boarding__body__content__sub-title">
                            Partagez vos difficultés de santé avec notre équipe
                            <br>pour vous accompagner au mieux.
                        </p>

                        <input
                            class="on-boarding__bory__content__difficulties__input"
                            type="text"
                            v-model="difficulties[0]"
                            placeholder="Aveugle..."
                            required
                        />

                        <input
                            class="on-boarding__bory__content__difficulties__input"
                            type="text"
                            v-model="difficulties[1]"
                            placeholder="Sourd..."
                            required
                        />

                        <input
                            class="on-boarding__bory__content__difficulties__input"
                            type="text"
                            v-model="difficulties[2]"
                            placeholder="Muet..."
                            required
                        />

                        <button class="on-boarding__body__button hover" v-on:click="addDifficulties">Continuer</button>
                    </div>
                </transition>

                <transition name="left">
                    <div class="on-boarding__body__content" v-if="onboard === 3">
                        <p class="on-boarding__body__content__title canala-deck">Bienvenue !</p>
                        <p class="on-boarding__body__content__sub-title">Utilisez au mieux MOP pour ne plus oublier vos traitements.</p>
                        <button class="on-boarding__body__button hover" v-on:click="$emit('on-boarding', false)">Continuer</button>
                    </div>
                </transition>
            </div>
        </div>
    </transition>
</template>

<script>
    import axios from 'axios'

    export default {
        props: {
            open: Boolean
        },

        data: () => ({
            onboard: 0,
            sonor: 0,
            vibror: 0,
            led: 0,
            difficulties: ['', '', '']
        }),

        methods: {
            async putRappels() {
                try {
                    const res = await axios.put(
                        process.env.VUE_APP_URL_API + '/rappels',
                        {
                            sonor: this.sonor ? "1" : "0",
                            vibror: this.vibror ? "1" : "0",
                            led: this.led ? "1" : "0"
                        },
                        {
                            headers: {
                                "Authorization": `Bearer ${this.$cookies.get('cookieMOP')}`
                            }
                        }
                    )

                    this.onboard += 1

                } catch(err) {
                    return this.$emit('error', err.response.data.message)
                }
            },

            async addDifficulties() {
                try {
                    for (const difficulty of this.difficulties) {
                        if (difficulty !== '') {
                            await axios.post(
                                process.env.VUE_APP_URL_API + '/difficulties',
                                {
                                    name: difficulty
                                },
                                {
                                    headers: {
                                        "Authorization": `Bearer ${this.$cookies.get('cookieMOP')}`
                                    }
                                }
                            )
                        }
                    }

                    this.onboard += 1
                    this.$route.query.on = ''

                } catch(err) {
                    return this.$emit('error', err.response.data.message)
                }
            }
        }
    }

</script>

<style scoped>

    .on-boarding-enter, .on-boarding-leave-to {
        opacity: 0;
    }

    .on-boarding-enter-active, .on-boarding-leave-active {
        transition: opacity 0.2s ease;
    }

    .left-enter-active {
        animation: left-to-right 0.2s ease-in;
    }

    .on-boarding {
        background: rgba(255,255,255,1);
        border-radius: 5px;
        border: 2px solid white;
        text-align: center;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        z-index: 100;
        color: black;
        box-shadow: 0 15px 40px 0 rgba(55, 61, 91, .10);
        width: 60vw;
        height: 60vh;
    }
    .on-boarding__body {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 80%;
        padding: 5% 10%;
    }

    .on-boarding__body__title,
    .on-boarding__body__content__title {
        font-size: 2vw;
        font-weight: 700;
        margin: 2% 0 0;
    }

    .on-boarding__body__title__sub-title,
    .on-boarding__body__content__sub-title {
        font-size: 1vw;
    }


    .on-boarding__body__button {
        background-color: var(--blue);
        border: none;
        color: #fff;
        border-radius: 4px;
        margin: 20px 0;
        width: 50%;
        height: 36px;
        font-size: 1vw;
        font-weight: 900;
        padding: 0 2%;
        opacity: 1;
        transition: all 0.2s ease-in;
    }

    .on-boarding__body__button:hover {
        opacity: 0.8;
        transition: all 0.2s ease-in;
    }

    .on-boarding__bory__content__rappels {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin: 5% 0;
    }

    .on-boarding__bory__content__rappels__one-rappel {
        padding: 5%;
        width: 20%;
        border: 1px solid var(--border);
        border-radius: 5px;
        transition: all 0.2s ease-in;
    }

    .on-boarding__bory__content__rappels__one-rappel:hover {
        border: 1px solid var(--blue);
        transition: all 0.2s ease-in;
    }

    .on-boarding__bory__content__rappels__one-rappel-active-sonor,
    .on-boarding__bory__content__rappels__one-rappel-active-led,
    .on-boarding__bory__content__rappels__one-rappel-active-vibror {
        border: 1px solid var(--blue);
        transition: all 0.2s ease-in;
    }

    .on-boarding__bory__content__rappels__one-rappel svg {
        width: 100%;
        height: 60px;
        margin: 5% 0;
    }

    .on-boarding__bory__content__difficulties__input {
        padding: 11px 12px 13px;
        height: 44px;
        font-size: 1vw;
        line-height: 1.33333333;

        border-radius: 4px;
        border: 1px solid var(--border);
        transition: border 80ms ease-out, box-shadow 80ms ease-out;
        box-sizing: border-box;
        margin: 0 auto 20px;
        padding: 1% 2%;
        height: 36px;
        width: 50%;
        outline: none !important;

        display: block;
    }    
    .on-boarding__bory__content__difficulties__input:focus {
        border-radius: 4px;
        box-shadow: 0 0 0 1px rgba(18, 100, 163, 1), 0 0 0 5px #1d9bd14d;
        outline: none !important;
        transition: border 80ms ease-out, box-shadow 80ms ease-out;
    }
    
    @keyframes left-to-right {
        0% {
            transform: translateX(50px);
        }
        100% {
            transform: translateX(0);
        }
    }
</style>